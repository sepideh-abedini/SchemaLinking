[
    {
        "instance_id": "bq113",
        "question": "Which county in Utah experienced the greatest percentage increase in construction employment from 2000 to 2018, calculated by averaging the employment levels during the third month of each quarter in those years? What is the corresponding percentage increase?",
        "external_knowledge": null,
        "question_toks": [
            "Which",
            "county",
            "in",
            "Utah",
            "experienced",
            "the",
            "greatest",
            "percentage",
            "increase",
            "in",
            "construction",
            "employment",
            "from",
            "2000",
            "to",
            "2018,",
            "calculated",
            "by",
            "averaging",
            "the",
            "employment",
            "levels",
            "during",
            "the",
            "third",
            "month",
            "of",
            "each",
            "quarter",
            "in",
            "those",
            "years?",
            "What",
            "is",
            "the",
            "corresponding",
            "percentage",
            "increase?"
        ],
        "query": "",
        "db_id": "bls",
        "No. of candidate columns": 23205,
        "No. of gold tables": 0
    },
    {
        "instance_id": "bq279",
        "question": "Can you provide the number of distinct active and closed bike share stations for each year 2013 and 2014?",
        "external_knowledge": null,
        "question_toks": [
            "Can",
            "you",
            "provide",
            "the",
            "number",
            "of",
            "distinct",
            "active",
            "and",
            "closed",
            "bike",
            "share",
            "stations",
            "for",
            "each",
            "year",
            "2013",
            "and",
            "2014?"
        ],
        "query": "SELECT\n    t.year,\n    CASE \n        WHEN t.year = 2013 THEN (\n                                  SELECT \n                                    COUNT(DISTINCT station_id)\n                                  FROM \n                                    `bigquery-public-data.austin_bikeshare.bikeshare_trips` t\n                                  INNER JOIN \n                                    `bigquery-public-data.austin_bikeshare.bikeshare_stations` s\n                                  ON \n                                    t.start_station_id = s.station_id\n                                  WHERE \n                                    s.status = 'active' AND EXTRACT(YEAR FROM start_time) = 2013\n                                 ) \n        WHEN t.year = 2014 THEN (\n                                  SELECT \n                                    COUNT(DISTINCT station_id)\n                                  FROM \n                                    `bigquery-public-data.austin_bikeshare.bikeshare_trips` t\n                                  INNER JOIN \n                                    `bigquery-public-data.austin_bikeshare.bikeshare_stations` s\n                                  ON \n                                    t.start_station_id = s.station_id\n                                  WHERE \n                                    s.status = 'active' AND EXTRACT(YEAR FROM start_time) = 2014\n                                 )\n    END\n    AS number_status_active,\n    CASE \n        WHEN t.year = 2013 THEN (\n                                  SELECT \n                                   COUNT(DISTINCT station_id)\n                                  FROM \n                                  `bigquery-public-data.austin_bikeshare.bikeshare_trips` t\n                                  INNER JOIN \n                                  `bigquery-public-data.austin_bikeshare.bikeshare_stations` s\n                                  ON \n                                   t.start_station_id = s.station_id\n                                  WHERE \n                                   s.status = 'closed' AND EXTRACT(YEAR FROM start_time) = 2013\n                                 ) \n        WHEN t.year = 2014 THEN (\n                                  SELECT \n                                  COUNT(DISTINCT station_id)\n                                  FROM \n                                    `bigquery-public-data.austin_bikeshare.bikeshare_trips` t\n                                  INNER JOIN \n                                    `bigquery-public-data.austin_bikeshare.bikeshare_stations` s\n                                  ON \n                                    t.start_station_id = s.station_id\n                                  WHERE \n                                    s.status = 'closed' AND EXTRACT(YEAR FROM start_time) = 2014\n                                 )\n    END\n    AS number_status_closed\nFROM\n    (\n      SELECT \n         EXTRACT(YEAR FROM start_time) AS year,\n         start_station_id\n      FROM\n         `bigquery-public-data.austin_bikeshare.bikeshare_trips`\n    ) \n    AS t\nINNER JOIN\n    `bigquery-public-data.austin_bikeshare.bikeshare_stations` s\nON\n    t.start_station_id = s.station_id\nWHERE\n    t.year BETWEEN 2013 AND 2014\nGROUP BY\n    t.year\nORDER BY\n    t.year",
        "db_id": "austin",
        "No. of candidate columns": 117,
        "No. of gold tables": 10
    },
    {
        "instance_id": "bq281",
        "question": "What is the highest number of electric bike rides lasting more than 10 minutes taken by subscribers with 'Student Membership' in a single day, excluding rides starting or ending at 'Mobile Station' or 'Repair Shop'?",
        "external_knowledge": null,
        "question_toks": [
            "What",
            "is",
            "the",
            "highest",
            "number",
            "of",
            "electric",
            "bike",
            "rides",
            "lasting",
            "more",
            "than",
            "10",
            "minutes",
            "taken",
            "by",
            "subscribers",
            "with",
            "'Student",
            "Membership'",
            "in",
            "a",
            "single",
            "day,",
            "excluding",
            "rides",
            "starting",
            "or",
            "ending",
            "at",
            "'Mobile",
            "Station'",
            "or",
            "'Repair",
            "Shop'?"
        ],
        "query": "SELECT\n  COUNT(1) AS num_rides\nFROM\n  `bigquery-public-data.austin_bikeshare.bikeshare_trips` \nWHERE \nstart_station_name \n    NOT IN ('Mobile Station', 'Repair Shop')\nAND\nend_station_name \n    NOT IN ('Mobile Station', 'Repair Shop')\nAND \nsubscriber_type = 'Student Membership'\nAND\nbike_type = 'electric'\nAND\nduration_minutes > 10\nGROUP BY \n    EXTRACT(YEAR from start_time), \n    EXTRACT(MONTH from start_time), \n    EXTRACT(DAY from start_time)\nORDER BY num_rides DESC\nLIMIT 1",
        "db_id": "austin",
        "No. of candidate columns": 117,
        "No. of gold tables": 1
    },
    {
        "instance_id": "bq112",
        "question": "Between 1998 and 2017, for Allegheny County in the Pittsburgh area, did the average annual wages for all industries keep pace with the inflation of all consumer items, and what were the respective percentage growth rates (to two decimal places) for wages and the CPI over that period?",
        "external_knowledge": null,
        "question_toks": [
            "Between",
            "1998",
            "and",
            "2017,",
            "for",
            "Allegheny",
            "County",
            "in",
            "the",
            "Pittsburgh",
            "area,",
            "did",
            "the",
            "average",
            "annual",
            "wages",
            "for",
            "all",
            "industries",
            "keep",
            "pace",
            "with",
            "the",
            "inflation",
            "of",
            "all",
            "consumer",
            "items,",
            "and",
            "what",
            "were",
            "the",
            "respective",
            "percentage",
            "growth",
            "rates",
            "(to",
            "two",
            "decimal",
            "places)",
            "for",
            "wages",
            "and",
            "the",
            "CPI",
            "over",
            "that",
            "period?"
        ],
        "query": "WITH geo AS (\n  SELECT DISTINCT geo_id\n  FROM `bigquery-public-data.geo_us_boundaries.counties`\n  WHERE county_name = \"Allegheny\" \n),\navg_wage_1998 AS(\n  SELECT\n    ROUND(AVG(avg_wkly_wage_10_total_all_industries) * 52, 2) AS wages_1998\n  FROM\n    `bigquery-public-data.bls_qcew.1998*`\n  WHERE\n    geoid = (SELECT geo_id FROM geo) --Selecting Allgeheny County\n),\n    \navg_wage_2017 AS (\n  SELECT\n    ROUND(AVG(avg_wkly_wage_10_total_all_industries) * 52, 2) AS wages_2017\n  FROM\n    `bigquery-public-data.bls_qcew.2017*`\n  WHERE\n    geoid = (SELECT geo_id FROM geo) --Selecting Allgeheny County\n),\n\navg_cpi_1998 AS (\n  SELECT\n    AVG(value) AS cpi_1998\n  FROM\n    `bigquery-public-data.bls.cpi_u` c\n  WHERE\n    year = 1998\n    AND item_code in (\n      SELECT DISTINCT item_code FROM `bigquery-public-data.bls.cpi_u` WHERE LOWER(item_name) = \"all items\"\n    )\n    AND area_code = (\n      SELECT DISTINCT area_code FROM `bigquery-public-data.bls.cpi_u` WHERE area_name LIKE '%Pittsburgh%'\n    )\n), \n-- A104 is the code for Pittsburgh, PA\n-- SA0 is the code for all items\n    \navg_cpi_2017 AS(\n  SELECT\n    AVG(value) AS cpi_2017\n  FROM\n    `bigquery-public-data.bls.cpi_u` c\n  WHERE\n    year = 2017\n    AND item_code in (\n      SELECT DISTINCT item_code FROM `bigquery-public-data.bls.cpi_u` WHERE LOWER(item_name) = \"all items\"\n    )\n    AND area_code = (\n      SELECT DISTINCT area_code FROM `bigquery-public-data.bls.cpi_u` WHERE area_name LIKE '%Pittsburgh%'\n    )\n)\n-- A104 is the code for Pittsburgh, PA\n-- SA0 is the code for all items\n\nSELECT\n  ROUND((wages_2017 - wages_1998) / wages_1998 * 100, 2) AS wages_percent_change,\n  ROUND((cpi_2017 - cpi_1998) / cpi_1998 * 100, 2) AS cpi_percent_change\nFROM\n  avg_wage_2017,\n  avg_wage_1998,\n  avg_cpi_2017,\n  avg_cpi_1998",
        "db_id": "bls",
        "No. of candidate columns": 23205,
        "No. of gold tables": 7
    }
]